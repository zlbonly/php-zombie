# php-zombie

## 1、僵尸(zombie)进程

* 僵尸进程是当子进程比父进程先结束，而父进程又没有回收子进程，释放子进程占用的资源，此时子进程将成为一个僵尸进程。如果父进程先退出 ，子进程被init接管，子进程退出后init会回收其占用的相关资源

* 说明： 个进程在调用exit命令结束自己的生命的时候，其实它并没有真正的被销毁， 而是留下一个称为僵尸进程（Zombie）的数据结构（系统调用exit，它的作用是使进程退出，但也仅仅限于将一个正常的进程变成一个僵尸进程，并不能将其完全销毁）
### 1.1 通过如下命令查看是否有僵尸进程，如果有，类似下面这

```
$ ps -A -o stat,ppid,pid,cmd | grep -e '^[Zz]'
Z+     282   283 [php] <defunct>
或者使用top命令查看：
$ top

top - 08:26:38 up 57 min,  1 user,  load average: 0.29, 0.37, 0.41
Tasks: 274 total,   1 running, 218 sleeping,   0 stopped,   1 zombie

```
### 2、僵尸进程的避免
* ⒈父进程通过wait和waitpid等函数等待子进程结束，这会导致父进程挂起。
* ⒉ 如果父进程很忙，那么可以用signal函数为SIGCHLD安装handler，因为子进程结束后， 父进程会收到该信号，可以在handler中调用wait回收。
* ⒊ 如果父进程不关心子进程什么时候结束，那么可以用signal（SIGCHLD,SIG_IGN） 通知内核，自己对子进程的结束不感兴趣，那么子进程结束后，内核会回收， 并不再给父进程发送信号。

### 孤儿进程
 * 孤儿进程：一个父进程退出，而它的一个或多个子进程还在运行，那么那些子进程将成为孤儿进程。孤儿进程将被init进程(进程号为1)所收养，并由init进程对它们完成状态收集工作。
